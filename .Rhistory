politics$alignment[politics$year == "5" & politics$value == "National People's Party"] <- 1
t <- data.frame(table(politics$alignment, politics$name, politics$year))
group <- as.data.table(t)
group$Var1 <- as.character(group$Var1)
group[duplicated(group[,-1])]
group$Var1[(group$Var2 == "Kiphire") & (group$Var3 == 2)] <- 1
group$Var1[(group$Var2 == "Longleng") & (group$Var3 == 2)] <- 1
group$Var1[(group$Var2 == "Longleng") & (group$Var3 == 3)] <- 1
group$Var1[(group$Var2 == "Mokokchung") & (group$Var3 == 3)] <- 1
group$Var1[(group$Var2 == "Peren") & (group$Var3 == 3)] <- 1
group$Var1[(group$Var2 == "Wokha") & (group$Var3 == 4)] <- 1
t <- group[group[, .I[which.max(Freq)], by= c("Var2", "Var3")]$V1]
alignment <- t[,1:3]
names(alignment)[1] <- "alignment"
names(alignment)[2] <- "name"
names(alignment)[3] <- "year"
data_nagaland <- merge(data_nagaland, alignment, by = c("name", "year"))
#PCS
data_nagalandx <- data_nagaland[,(colnames(data_nagaland) %like% 'Shape_Area')]
data_nagalandx <- data_nagalandx[,which(colSums(data_nagalandx) != 0)]
data_nagalandx <- data_nagalandx[, -c(1:2)]
names(data_nagalandx)[1] <- "GSS_MNEF"
names(data_nagalandx)[2] <- "GSS_MDF"
names(data_nagalandx)[3] <- "GSS_ASUA"
names(data_nagalandx)[4] <- "MC_ASUA"
names(data_nagalandx)[5] <- "MDF_GSS"
names(data_nagalandx)[6] <- "MNEF_GSS"
names(data_nagalandx)[7] <- "MNEF_AUSA"
names(data_nagalandx)[8] <- "MNEF_MC"
names(data_nagalandx)[9] <- "MC_MNEF"
names(data_nagalandx)[10] <- "MC_MDF"
pca1 <- prcomp(data_nagalandx, scale = T)
comps1 <- pca1$x
screeplot(pca1, type='l', main="", npcs = 9)
library(ggplot2)
var_explained <- pca1$sdev^2 / sum(pca1$sdev^2)
qplot(c(1:4), var_explained) +
geom_line() +
xlab("Principal Component") +
ylab("Variance Explained") +
ggtitle("Scree Plot")
pca_var1 <- pca1$sdev^2
which(pca_var1 >= .8)
total_var1 <- sum(pca_var1)
sum(pca_var1[1:4]/total_var1)
pca_var1[4]
data_pcs1 <- comps1[,1:4]
head(pca1$rotation[,1][order(pca1$rotation[,1],decreasing = T)])
tail(pca1$rotation[,1][order(pca1$rotation[,1],decreasing = T)])
head(pca1$rotation[,2][order(pca1$rotation[,2],decreasing = T)])
tail(pca1$rotation[,2][order(pca1$rotation[,2],decreasing = T)])
pca1$rotation[,3][order(pca1$rotation[,3],decreasing = T)]
tail(pca1$rotation[,3][order(pca1$rotation[,3],decreasing = T)])
head(pca1$rotation[,4][order(pca1$rotation[,4],decreasing = T)])
tail(pca1$rotation[,4][order(pca1$rotation[,4],decreasing = T)])
stargazer(pca1$rotation[,1],type = "html", out = "PC1.doc")
stargazer(pca1$rotation[,2],type = "html", out = "PC2.doc")
stargazer(pca1$rotation[,3],type = "html", out = "PC3.doc")
stargazer(pca1$rotation[,4],type = "html", out = "PC4.doc")
library(raster)
library(spdep)
library(MASS)
library(lme4)
library(stargazer)
library(rgdal)
library(plyr)
library(spatialreg)
library(spaMM)
detach("package:ggplot2")
s <- shapefile("/Users/giuliabrutti/Desktop/tesi/NE_districts.shp")
s
dim(s)
names(s)
ss <- aggregate(s, "state")
shape <- s[,1]
mer1 <- merge(shape, data_LULC_1, by = "name")
mer2 <- merge(shape, data_LULC_2, by = "name")
mer3 <- merge(shape, data_LULC_3, by = "name")
mer4 <- merge(shape, data_LULC_4, by = "name")
mer5 <- merge(shape, data_LULC_5, by = "name")
# grps <- 10
# brks <- quantile(data_LULC$incidents, 0:(grps-1)/(grps-1), na.rm=TRUE)
#
# p1 <- spplot(mer1, "incidents", at=brks, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent" )
# p1 + layer(sp.polygons(mer1))
#
# p2 <- spplot(mer2, "incidents", at=brks, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent" )
# p2 + layer(sp.polygons(mer2))
#
# p3 <- spplot(mer3, "incidents", at=brks, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent" )
# p3 + layer(sp.polygons(mer3))
#
# p4 <- spplot(mer4, "incidents", at=brks, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent" )
# p4 + layer(sp.polygons(mer4))
#
# mer <- rbind(mer1, mer2, mer3, mer4)
# names(mer)
#
# f1 <- incidents ~ pop_growth + incidents_prior + year
# m1 <- glm.nb(f1, data=mer)
# summary(m1)
#
# mer$residuals <- residuals(m1)
nb1 <- poly2nb(mer1, queen = T)
nb2 <- poly2nb(mer2, queen = T)
nb3 <- poly2nb(mer3, queen = T)
nb4 <- poly2nb(mer4, queen = T)
nb5 <- poly2nb(mer5, queen = T)
#resnb <- sapply(nb, function(x) mean(mer$residuals[x]))
#cor(mer$residuals, resnb)
#plot(mer$residuals, resnb, xlab='Residuals', ylab='Mean adjacent residuals')
lw1 <- nb2listw(nb1)
lw2 <- nb2listw(nb2)
lw3 <- nb2listw(nb3)
lw4 <- nb2listw(nb4)
lw5 <- nb2listw(nb5)
#moran.mc(mer$residuals, lw, 999)
# m1s <- lagsarlm(f1, data=mer, lw)
# summary(m1s)
#
# m1e <- errorsarlm(f1, data=mer, lw)
# summary(m1e)
#
# moran.mc(mer$incidents, lw, 999)
#
# moran.plot(mer$incidents, lw)
#
# lm.morantest(m1,lw)
#######
# mod <- fitme(f1, adjMatrix = nb, data = data.frame(mer), family = negbin(1.5))
# summary(mod)
#
# mod1 <- fitme(incidents ~ scale(pop_growth) + incidents_prior + year + (1 | state), adjMatrix = nb, data = data.frame(mer), family = negbin(1.5))
# summary(mod1)
#
# mod2 <- fitme(incidents ~ scale(pop_growth) + incidents_prior + year + (scale(pop_growth) | state), adjMatrix = nb, data = data.frame(mer), family = negbin(1.5))
# summary(mod2)
#
# anova(mod1, mod2)
###
mer1$lag_rate <- lag.listw(x=lw1, var=mer1$incidents)
mer2$lag_rate <- lag.listw(x=lw2, var=mer2$incidents)
mer3$lag_rate <- lag.listw(x=lw3, var=mer3$incidents)
mer4$lag_rate <- lag.listw(x=lw1, var=mer4$incidents)
mer5$lag_rate <- lag.listw(x=lw1, var=mer5$incidents)
mer <- rbind(mer1, mer2, mer3, mer4, mer5)
names(mer)[2] <- "time"
names(mer)[4] <- "violence"
names(mer)[49] <- "pgrowth"
names(mer)[48] <- "vprior"
names(mer)[10] <- "GSS_MNEF"
names(mer)[11] <- "GSS_MDF"
names(mer)[12] <- "GSS_ASUA"
names(mer)[13] <- "MC_ASUA"
names(mer)[14] <- "MDF_GSS"
names(mer)[15] <- "MDF_MC"
names(mer)[16] <- "MNEF_GSS"
names(mer)[17] <- "SW_ASUA"
names(mer)[18] <- "MNEF_ASUA"
names(mer)[19] <- "MNEF_MC"
names(mer)[20] <- "MDF_ASUA"
names(mer)[21] <- "SW_BA"
names(mer)[22] <- "SW_GSS"
names(mer)[23] <- "BA_GSS"
names(mer)[24] <- "GSS_SW"
names(mer)[25] <- "MC_MNEF"
names(mer)[26] <- "MNEF_BA"
names(mer)[27] <- "GSS_SUFV"
names(mer)[28] <- "SW_SOFV"
names(mer)[29] <- "BA_MC"
names(mer)[30] <- "BA_SW"
names(mer)[31] <- "MC_BA"
names(mer)[32] <- "MC_SW"
names(mer)[33] <- "SW_MC"
names(mer)[34] <- "MC_SOFV"
names(mer)[35] <- "MC_MDF"
names(mer)[36] <- "SOFV_ASUA"
names(mer)[37] <- "SW_SV"
names(mer)[38] <- "GSS_BA"
names(mer)[39] <- "MNEF_SW"
names(mer)[40] <- "SW_MNEF"
names(mer)[41] <- "SOFV_MC"
names(mer)[42] <- "SOFV_SW"
names(mer)[43] <- "MC_SV"
names(mer)[44] <- "SOFV_GSS"
names(mer)[45] <- "BA_SV"
names(mer)[46] <- "SV_SW"
names(mer)[47] <- "MDF_SW"
names(mer)[50] <- "spatial_lag"
mod0 <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time, data = data.frame(mer))
summary(mod0)
stargazer(mod0, type = "html", out = "model_1.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod0),3))))
mix.int <- glmer.nb(violence ~ scale(spatial_lag) + scale(pgrowth) + scale(vprior) + time + (1 | state), data = data.frame(mer))
summary(mix.int)
mix.slope <- glmer.nb(violence ~ scale(spatial_lag) + scale(pgrowth) + scale(vprior) + time + (scale(pgrowth) | state), data = data.frame(mer))
summary(mix.slope)
ranef(mix.slope)
stargazer(mix.int,mix.slope, type = "html", out = "model_2.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mix.int),3),round(BIC(mix.slope),3))))
confint(mix.slope, oldNames = T, devtol = 1e-3)
options(knitr.kable.NA = '')
kable(anova(mix.slope, mix.int))
AIC(mix.slope)
AIC(mix.int)
#### winsorized
library(DescTools)
wind <- mer
wind$incidents <- Winsorize(mer$violence)
mod_win <- glm.nb(incidents ~ lag_rate + pop_growth + incidents_prior + year, data = data.frame(wind))
summary(mod0)
mix.int_win <- glmer.nb(incidents ~ scale(lag_rate) + scale(pop_growth) + scale(incidents_prior) + year + (1 | state), data = data.frame(wind))
summary(mix.int)
mix.slope_win <- glmer.nb(incidents ~ scale(lag_rate) + scale(pop_growth) + scale(incidents_prior) + year + (scale(pop_growth) | state), data = data.frame(wind))
summary(mix.slope)
ranef(mix.slope)
anova(mix.int, mix.slope)
moran.test(mer1$incidents, lw1)
moran.test(mer2$incidents, lw2)
moran.test(mer3$incidents, lw3)
moran.test(mer4$incidents, lw4)
moran.test(mer5$incidents, lw5)
moran.mc(mer1$incidents, lw1, nsim=999)
moran.mc(mer2$incidents, lw2, nsim=999)
moran.mc(mer3$incidents, lw3, nsim=999)
moran.mc(mer4$incidents, lw4, nsim=999)
moran.mc(mer5$incidents, lw5, nsim=999)
moran.mc(mer$incidents, lw, nsim = 999)
sum(mer$incidents[mer$year == 5])
#offset
mod <- glm.nb(incidents ~ lag_rate + pop_growth + incidents_prior + year + offset(log(pop)), data = data.frame(mer))
summary(mod)
library(lmtest)
detach("package:ggplot2", unload=TRUE)
mer_naga <- mer[mer$state == "Nagaland",]
mer_naga_1 <- mer_naga[mer_naga$time == "1",]
mer_naga_2 <- mer_naga[mer_naga$time == "2",]
mer_naga_3 <- mer_naga[mer_naga$time == "3",]
mer_naga_4 <- mer_naga[mer_naga$time == "4",]
mer_naga_5 <- mer_naga[mer_naga$time == "5",]
nb_naga1 <- poly2nb(mer_naga_1, queen = T)
nb_naga2 <- poly2nb(mer_naga_2, queen = T)
nb_naga3 <- poly2nb(mer_naga_3, queen = T)
nb_naga4 <- poly2nb(mer_naga_4, queen = T)
nb_naga5 <- poly2nb(mer_naga_5, queen = T)
lw_naga <- nb2listw(nb_naga1)
lw_naga <- nb2listw(nb_naga2)
lw_naga <- nb2listw(nb_naga3)
lw_naga <- nb2listw(nb_naga4)
lw_naga <- nb2listw(nb_naga5)
mer_naga_1$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_1$violence)
mer_naga_2$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_2$violence)
mer_naga_3$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_3$violence)
mer_naga_4$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_4$violence)
mer_naga_5$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_5$violence)
mer_naga <- rbind(mer_naga_1, mer_naga_2, mer_naga_3, mer_naga_4, mer_naga_5)
for (i in 1:nrow(mer_naga)){
mer_naga$alignemnt[i] <- data_nagaland$alignment[(data_nagaland$name == mer_naga$name[i]) & (data_nagaland$year == mer_naga$time[i])]
}
dat <- cbind(data_nagaland[,1:2], data_pcs1)
names(dat)[2] <- "time"
mer_naga <- merge(data.frame(mer_naga), dat, by = c("name", "time"))
names(mer_naga)[51] <- "forest_recovery"
names(mer_naga)[52] <- "urbanization"
names(mer_naga)[53] <- "forest_contrast"
names(mer_naga)[54] <- "urban_contrast"
mod1 <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time, data = mer_naga, control=glm.control(maxit=50))
summary(mod1)
mod2 <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time, data = mer_naga, control=glm.control(maxit=50))
summary(mod2)
mod3 <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + alignemnt + vprior + time, data = mer_naga, control=glm.control(maxit=50))
summary(mod3)
View(data_nagaland)
for (i in 1:nrow(mer_naga)){
mer_naga$alignemnt[i] <- data_nagaland$alignment[(data_nagaland$name == mer_naga$name[i]) & (data_nagaland$year == mer_naga$time[i])]
}
View(data_nagaland)
View(mer_naga)
mer_naga$name[1]
for (i in 1:nrow(mer_naga)){
mer_naga$alignemnt[i] <- data_nagaland$alignment[(data_nagaland$name == mer_naga$name[i]) & (data_nagaland$year == mer_naga$time[i])]
}
View(mer_naga)
dat <- cbind(data_nagaland[,1:2], data_pcs1)
names(dat)[2] <- "time"
mer_naga <- merge(data.frame(mer_naga), dat, by = c("name", "time"))
names(mer_naga)
library(lmtest)
detach("package:ggplot2", unload=TRUE)
mer_naga <- mer[mer$state == "Nagaland",]
mer_naga_1 <- mer_naga[mer_naga$time == "1",]
mer_naga_2 <- mer_naga[mer_naga$time == "2",]
mer_naga_3 <- mer_naga[mer_naga$time == "3",]
mer_naga_4 <- mer_naga[mer_naga$time == "4",]
mer_naga_5 <- mer_naga[mer_naga$time == "5",]
# brks2 <- quantile(data_LULC$pop_growth, 0:(grps-1)/(grps-1), na.rm=TRUE)
#
# p_naga1 <- spplot(mer_naga_1, "incidents", at=brks, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent")
# p_naga1 + layer(sp.polygons(mer_naga_1))
#
# p_naga1 <- spplot(mer_naga_1, "pop_growth", at=brks2, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent")
# p_naga1 + layer(sp.polygons(mer_naga_1))
#
# p_naga2 <- spplot(mer_naga_2, "incidents", at=brks, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent")
# p_naga2 + layer(sp.polygons(mer_naga_2))
#
# p_naga2 <- spplot(mer_naga_2, "pop_growth", at=brks2, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent")
# p_naga2 + layer(sp.polygons(mer_naga_2))
#
# p_naga3 <- spplot(mer_naga_3, "incidents", at=brks, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent")
# p_naga3 + layer(sp.polygons(mer_naga_3))
#
# p_naga3 <- spplot(mer_naga_3, "pop_growth", at=brks2, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent")
# p_naga3 + layer(sp.polygons(mer_naga_3))
#
# p_naga4 <- spplot(mer_naga_4, "incidents", at=brks, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent")
# p_naga4 + layer(sp.polygons(mer_naga_4))
#
# p_naga4 <- spplot(mer_naga_4, "pop_growth", at=brks2, col.regions=rev(brewer.pal(grps, "RdBu")), col="transparent")
# p_naga4 + layer(sp.polygons(mer_naga_4))
nb_naga1 <- poly2nb(mer_naga_1, queen = T)
nb_naga2 <- poly2nb(mer_naga_2, queen = T)
nb_naga3 <- poly2nb(mer_naga_3, queen = T)
nb_naga4 <- poly2nb(mer_naga_4, queen = T)
nb_naga5 <- poly2nb(mer_naga_5, queen = T)
lw_naga <- nb2listw(nb_naga1)
lw_naga <- nb2listw(nb_naga2)
lw_naga <- nb2listw(nb_naga3)
lw_naga <- nb2listw(nb_naga4)
lw_naga <- nb2listw(nb_naga5)
mer_naga_1$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_1$violence)
mer_naga_2$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_2$violence)
mer_naga_3$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_3$violence)
mer_naga_4$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_4$violence)
mer_naga_5$spatial_lag <- lag.listw(x=lw_naga, var=mer_naga_5$violence)
mer_naga <- rbind(mer_naga_1, mer_naga_2, mer_naga_3, mer_naga_4, mer_naga_5)
for (i in 1:nrow(mer_naga)){
mer_naga$alignemnt[i] <- data_nagaland$alignment[(data_nagaland$name == mer_naga$name[i]) & (data_nagaland$year == mer_naga$time[i])]
}
dat <- cbind(data_nagaland[,1:2], data_pcs1)
names(dat)[2] <- "time"
mer_naga <- merge(data.frame(mer_naga), dat, by = c("name", "time"))
names(mer_naga)
names(mer_naga)[52] <- "forest_recovery"
names(mer_naga)[53] <- "urbanization"
names(mer_naga)[54] <- "forest_contrast"
names(mer_naga)[55] <- "urban_contrast"
mod1 <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time, data = mer_naga, control=glm.control(maxit=50))
summary(mod1)
mod2 <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time, data = mer_naga, control=glm.control(maxit=50))
summary(mod2)
mod3 <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + alignemnt + vprior + time, data = mer_naga, control=glm.control(maxit=50))
summary(mod3)
mod4 <- glm.nb(violence ~ spatial_lag + forest_recovery + urbanization + forest_contrast + urban_contrast + alignemnt + vprior + time, data = mer_naga, control=glm.control(maxit=50))
summary(mod4)
stargazer(mod1, mod2, mod3, mod4 type = "html", out = "model_3.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod1),3),round(BIC(mod2),3),round(BIC(mod3),3)), round(BIC(mod4),3))))
stargazer(mod1, mod2, mod3, mod4, type = "html", out = "model_3.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod1),3),round(BIC(mod2),3),round(BIC(mod3),3)), round(BIC(mod4),3))))
stargazer(mod1, mod2, mod3, mod4, type = "html", out = "model_3.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod1),3),round(BIC(mod2),3),round(BIC(mod3),3)), round(BIC(mod4),3))))
stargazer(mod1, mod2, mod3, mod4, type = "html", out = "model_3.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod1),3),round(BIC(mod2),3),round(BIC(mod3),3)), round(BIC(mod4),3)))
###
library(DescTools)
win_naga <- mer_naga
win_naga$incidents <- round(Winsorize(mer_naga$incidents))
win_naga$incidents <- round(Winsorize(mer_naga$violence))
mod2_w <- glm.nb(incidents ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time, data = win_naga, control=glm.control(maxit=50))
mod1_w <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time, data = win_naga, control=glm.control(maxit=50))
summary(mod)
mod2_w <- glm.nb(incidents ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time, data = win_naga, control=glm.control(maxit=50))
summary(mod)
mod4_w <- glm.nb(incidents ~ lag_rate+ forest_recovery + urbanization + forest_contrast + urban_contrast + incidents_prior + year + alignemnt, data = win_naga, control=glm.control(maxit=50))
stargazer(mod1_w, mod2_w, mod3_w, mod4_w, type = "html", out = "model_w.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod1_w),3),round(BIC(mod2_w),3),round(BIC(mod3_w),3)), round(BIC(mod4_w),3)))
mod1_w <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time, data = win_naga, control=glm.control(maxit=50))
mod2_w <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time, data = win_naga, control=glm.control(maxit=50))
mod3_w <- glm.nb(violence ~ lag_rate + pop_growth + forest_recovery + urbanization + forest_contrast + urban_contrast + incidents_prior + year + alignemnt, data = win_naga, control=glm.control(maxit=50))
mod2_w <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time, data = win_naga, control=glm.control(maxit=50))
mod3_w <- glm.nb(violence ~ spatial_lag + pop_growth + forest_recovery + urbanization + forest_contrast + urban_contrast + incidents_prior + year + alignemnt, data = win_naga, control=glm.control(maxit=50))
mod1_w <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time, data = win_naga, control=glm.control(maxit=50))
mod2_w <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time, data = win_naga, control=glm.control(maxit=50))
mod3_w <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time + alignemnt, data = win_naga, control=glm.control(maxit=50))
mod4_w <- glm.nb(violence ~ spatial_lag + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time + alignemnt, data = win_naga, control=glm.control(maxit=50))
stargazer(mod1_w, mod2_w, mod3_w, mod4_w, type = "html", out = "model_w.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod1_w),3),round(BIC(mod2_w),3),round(BIC(mod3_w),3)), round(BIC(mod4_w),3)))
#### winsorized
library(DescTools)
wind <- mer
wind$incidents <- Winsorize(mer$violence)
mod_win <- glm.nb(incidents ~ lag_rate + pop_growth + incidents_prior + year, data = data.frame(wind))
mod_win <- glm.nb(incidents ~ spatial_lag + pgrowth + vprior + time, data = data.frame(wind))
stargazer(mix.int,mix.slope, type = "html", out = "model_2.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod_win),3))))
stargazer(mix.int,mix.slope, type = "html", out = "model_win.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod_win),3))))
stargazer(mod_win, type = "html", out = "model_win.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod_win),3))))
mod_win <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time, data = data.frame(wind))
#### winsorized
library(DescTools)
wind <- mer
wind$violence <- Winsorize(mer$violence)
mod_win <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time, data = data.frame(wind))
stargazer(mod_win, type = "html", out = "model_win.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod_win),3))))
mix.int_win <- glmer.nb(incidents ~ scale(lag_rate) + scale(pop_growth) + scale(incidents_prior) + year + (1 | state), data = data.frame(wind))
mix.int_win <- glmer.nb(violence ~ scale(spatial_lag) + scale(pgrowth) + scale(vprior) + time + (1 | state), data = data.frame(wind))
mix.slope_win <- glmer.nb(incidents ~ scale(spatial_lag) + scale(pgrowth) + scale(vprior) + time + (scale(pop_growth) | state), data = data.frame(wind))
mix.slope_win <- glmer.nb(violence ~ scale(spatial_lag) + scale(pgrowth) + scale(vprior) + time + (scale(pop_growth) | state), data = data.frame(wind))
mix.slope_win <- glmer.nb(violence ~ scale(spatial_lag) + scale(pgrowth) + scale(vprior) + time + (scale(pgrowth) | state), data = data.frame(wind))
stargazer(mix.int_win, mix.slope_win, type = "html", out = "model_win_random.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mix.int_win),3), round(BIC(mix.slope_win),3))))
anova(mix.int_win, mix.slope_win)
library(lmtest)
lrtest(mod1,mod2)
lrtest(mod1,mod3)
mod <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time + offset(log(pop)), data = data.frame(mer))
summary(mod)
stargazer(mod, type = "html", out = "model_off.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod),3))))
mod1_off <- glm.nb(violence ~ spatial_lag + pgrowth + incidents_prior + time + offset(log(pop)), data = mer_naga, control=glm.control(maxit=50))
summary(mod)
mod1_off <- glm.nb(violence ~ spatial_lag + pgrowth + vprior + time + offset(log(pop)), data = mer_naga, control=glm.control(maxit=50))
summary(mod)
mod2_off <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time + offset(log(pop)), data = mer_naga, control=glm.control(maxit=50))
summary(mod)
mod3_off <- glm.nb(violence ~ spatial_lag + pgrowth + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time + alignemnt + offset(log(pop)), data = mer_naga, control=glm.control(maxit=50))
summary(mod)
mod4_off <- glm.nb(vioelnce ~ spatial_lag + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time + alignemnt + offset(log(pop)), data = mer_naga, control=glm.control(maxit=50))
summary(mod)
mod4_off <- glm.nb(violence ~ spatial_lag + forest_recovery + urbanization + forest_contrast + urban_contrast + vprior + time + alignemnt + offset(log(pop)), data = mer_naga, control=glm.control(maxit=50))
stargazer(mod1_off, mod2_off, mod3_off, mod4_off, type = "html", out = "model_off_naga.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod1_off),3),round(BIC(mod2_off),3),round(BIC(mod3_off),3)), round(BIC(mod4_off),3)))
mix.int_off <- glmer.nb(violence ~ scale(spatial_lag) + scale(pgrowth) + scale(vprior) + time + offset(log(pop)) + (1 | state), data = data.frame(mer))
mix.slope_off <- glmer.nb(violence ~ scale(spatial_lag) + scale(pgrowth) + scale(vprior) + time + offset(log(pop)) + (scale(pgrowth) | state), data = data.frame(mer))
stargazer(mix.int_off, mix.slope_off, type = "html", out = "model_off_random.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mix.int_off),3), round(BIC(mix.slope_off),3))))
#binomial
mer_naga$alignemnt <- as.numeric(mer_naga$alignemnt)
mod <- glm(alignemnt ~ pgrowth + time, data = mer_naga, family = "binomial")
summary(mod)
stargazer(mod, type = "html", out = "model_binary.doc", style = "ajps", star.cutoffs = c(0.05, 0.01, 0.001), add.lines=list(c("BIC", round(BIC(mod),3)))
)
moran.test(mer1$incidents, lw1)
moran.test(mer2$incidents, lw2)
moran.test(mer3$incidents, lw3)
moran.test(mer4$incidents, lw4)
moran.test(mer5$incidents, lw5)
moran.test(mer1$incidents, lw1)
moran.test(mer2$incidents, lw2)
moran.test(mer3$incidents, lw3)
moran.test(mer4$incidents, lw4)
moran.test(mer5$incidents, lw5)
plto(dat$PC4, mer_naga$violence)
plot(dat$PC4, mer_naga$violence)
ggplot(dat$PC4, mer_naga$violence)
library(ggplot2)
ggplot(data=mer_naga, aes(x=urban_contrast, y=violence))+geom_point() +facet_wrap(~time)
ggplot(data=mer_naga, aes(x=urban_contrast, y=violence))+geom_point()
setwd("/Users/giuliabrutti/Documents/GitHub/MY499_code/data_cleaning")
df <- read.csv("data/pop_incidents_GOV.csv")
df <- read.csv("..data/pop_incidents_GOV.csv")
setwd("/Users/giuliabrutti/Documents/GitHub/MY499_code")
df <- read.csv("..data/pop_incidents_GOV.csv")
df <- read.csv("data/pop_incidents_GOV.csv")
setwd("/Users/giuliabrutti/Documents/GitHub/MY499_code")
df <- read.csv("data/pop_incidents_GOV.csv")
df$popchange_9095 <- df$POP1995 - df$POP1990
df$popchange_9500 <- df$POP2000 - df$POP1995
df$popchange_0005 <- df$POP2005 - df$POP2000
df$popchange_0510 <- df$POP2010 - df$POP2005
df$popchange_1015 <- df$POP2015 - df$POP2010
pop_9091 <- data.frame(aggregate(df$POP1990, by = list(df$state), FUN = sum))
pop_9596 <- data.frame(aggregate(df$POP1995, by = list(df$state), FUN = sum))
pop_0001 <- data.frame(aggregate(df$POP2000, by = list(df$state), FUN = sum))
pop_0506 <- data.frame(aggregate(df$POP2005, by = list(df$state), FUN = sum))
pop_1011 <- data.frame(aggregate(df$POP2010, by = list(df$state), FUN = sum))
pop_1516 <- data.frame(aggregate(df$POP2015, by = list(df$state), FUN = sum))
df_incidents <- df[,c(1, 11:15)]
df_pop_change <- df[, c(1, 16:20)]
df_pop <- df[, c(1, 3:7)]
df_1 <- melt(setDT(df_incidents), id = 1, variable.name = "year")
df_2 <- melt(setDT(df_pop_change), id = 1, variable.name = "year")
df_3 <- melt(setDT(df_pop), id = 1, variable.name = "year")
df_2$year <- as.character(df_2$year)
df_2[df_2 == "popchange_9095"] <- "1"
df_2[df_2 == "popchange_9500"] <- "2"
df_2[df_2 == "popchange_0005"] <- "3"
df <- read.csv("data/pop_incidents_GOV.csv")
df$popchange_9095 <- df$POP1995 - df$POP1990
View(df)
df$popchange_9095 <- df$POP1995 - df$POP1990
df$popchange_9500 <- df$POP2000 - df$POP1995
df$popchange_0005 <- df$POP2005 - df$POP2000
df$popchange_0510 <- df$POP2010 - df$POP2005
df$popchange_1015 <- df$POP2015 - df$POP2010
pop_9091 <- data.frame(aggregate(df$POP1990, by = list(df$state), FUN = sum))
pop_9596 <- data.frame(aggregate(df$POP1995, by = list(df$state), FUN = sum))
pop_0001 <- data.frame(aggregate(df$POP2000, by = list(df$state), FUN = sum))
pop_0506 <- data.frame(aggregate(df$POP2005, by = list(df$state), FUN = sum))
pop_1011 <- data.frame(aggregate(df$POP2010, by = list(df$state), FUN = sum))
pop_1516 <- data.frame(aggregate(df$POP2015, by = list(df$state), FUN = sum))
df_incidents <- df[,c(1, 11:15)]
df_pop_change <- df[, c(1, 16:20)]
df_pop <- df[, c(1, 3:7)]
df_1 <- melt(setDT(df_incidents), id = 1, variable.name = "year")
df_2 <- melt(setDT(df_pop_change), id = 1, variable.name = "year")
df_3 <- melt(setDT(df_pop), id = 1, variable.name = "year")
View(df_1)
df_2$year <- as.character(df_2$year)
df_1 <- melt(setDT(df_incidents), id = 1, variable.name = "year")
View(df_1)
# library(MASS)
library(reshape)
df_1 <- melt(setDT(df_incidents), id = 1, variable.name = "year")
df_2 <- melt(setDT(df_pop_change), id = 1, variable.name = "year")
df_3 <- melt(setDT(df_pop), id = 1, variable.name = "year")
df_2$year <- as.character(df_2$year)
# library(MASS)
library(reshape)
library(data.table)
df_1 <- melt(setDT(df_incidents), id = 1, variable.name = "year")
df_2 <- melt(setDT(df_pop_change), id = 1, variable.name = "year")
df_3 <- melt(setDT(df_pop), id = 1, variable.name = "year")
df_2$year <- as.character(df_2$year)
View(df_1)
